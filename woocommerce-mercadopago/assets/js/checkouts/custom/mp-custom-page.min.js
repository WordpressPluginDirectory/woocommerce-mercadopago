const CheckoutPage={installmentsEnabled:!1,setElementDisplay(e,t){document.querySelector(CheckoutElements[e]).style.display=t},setText(e,t){document.querySelector(CheckoutElements[e]).innerHTML=t},setValueOn(e,t){document.querySelector(CheckoutElements[e]).value=t},setBackground(e,t){document.querySelector(CheckoutElements[e]).style.setProperty("background",t,"important")},setImageCard(e){this.setBackground("fcCardNumberContainer","url("+e+") 98% 50% no-repeat #fff"),document.querySelector(CheckoutElements.fcCardNumberContainer).style.setProperty("background-size","auto","important")},findContainerField(e){let t="cardholderName"===e?`#form-checkout__${e}`:`#form-checkout__${e}-container`;return Object.keys(CheckoutElements).find((e=>CheckoutElements[e]===t))},setDisplayOfError(e,t,n,r="customContent"){let s=document.querySelector(CheckoutElements[r]).querySelector(CheckoutElements[e]);s&&("add"===t?s.classList.add(`${n}`):s.classList.remove(`${n}`))},setDisplayOfInputHelper(e,t,n="customContent"){let r=document.querySelector(CheckoutElements[n]).querySelector(`input-helper[input-id=${e}-helper]`);if(r){r.querySelector("div").style.display=t}},setDisplayOfInputHelperMessage(e,t,n="customContent"){let r=document.querySelector(CheckoutElements[n]).querySelector(`input-helper[input-id=${e}-helper]`);if(r){r.querySelector("div").childNodes[1].innerHTML=t}},setCvvConfig(e){this.setCvvHint(e.length),this.changeCvvPlaceHolder(e.length)},changeCvvPlaceHolder(e){3===e?window.mpCustomCheckoutHandler.cardForm.form.update("securityCode",{placeholder:wc_mercadopago_custom_page_params.security_code_placeholder_text_3_digits}):window.mpCustomCheckoutHandler.cardForm.form.update("securityCode",{placeholder:wc_mercadopago_custom_page_params.security_code_placeholder_text_4_digits})},setCvvHint(e){3===e?document.querySelector(CheckoutElements.mpSecurityCodeInfo).setAttribute("data-tooltip",wc_mercadopago_custom_page_params.security_code_tooltip_text_3_digits):document.querySelector(CheckoutElements.mpSecurityCodeInfo).setAttribute("data-tooltip",wc_mercadopago_custom_page_params.security_code_tooltip_text_4_digits)},additionalInfoHandler(e){e.cardholder_name?this.setElementDisplay("fcCardholderName","block"):this.setElementDisplay("fcCardholderName","none"),e.issuer?this.setElementDisplay("mpIssuerContainer","block"):this.setElementDisplay("mpIssuerContainer","none"),e.cardholder_identification_type&&e.cardholder_identification_number?this.setElementDisplay("mpDocumentContainer","block"):this.setElementDisplay("mpDocumentContainer","none")},getCountry:()=>wc_mercadopago_custom_checkout_params.site_id,formatCurrency(e){let t=new Intl.NumberFormat(wc_mercadopago_custom_checkout_params.intl,{currency:wc_mercadopago_custom_checkout_params.currency,style:"currency",currencyDisplay:"narrowSymbol"}).format(e);return"MLM"===this.getCountry()&&(t=t.replace(/^(\D+)/,"$1 ")),t},inputHelperName:e=>({cardNumber:CheckoutElements.mpCardNumber,cardholderName:CheckoutElements.mpCardholderName,expirationDate:CheckoutElements.mpExpirationDate,securityCode:CheckoutElements.mpSecurityCode,identificationNumber:CheckoutElements.mpIdentificationNumber}[e]),removeAdditionFields(){this.setElementDisplay("mpDocumentContainer","none"),this.setElementDisplay("mpInstallmentsCard","none"),this.setElementDisplay("mpIssuerContainer","none"),this.setValueOn("cardInstallments","")},getHelperMessage(e){let t="input-helper[input-id="+this.inputHelperName(e)+"-helper]";return document.querySelector(t).querySelector("div[class=mp-helper]").childNodes[1]},verifyDocument(){let e=document.querySelector(CheckoutElements.fcIdentificationNumber),t=document.querySelector(CheckoutElements.mpDocumentContainer);return"none"===t.style.display||""===t.style.display||"-1"!==e.value&&""!==e.value&&"flex"!==document.querySelector("input-helper[input-id=mp-doc-number-helper]").querySelector("div").style.display},loadAdditionalInfo(e){const t={issuer:!1,cardholder_name:!1,cardholder_identification_type:!1,cardholder_identification_number:!1};for(let n=0;n<e.length;n++)"issuer_id"===e[n]&&(t.issuer=!0),"cardholder_name"===e[n]&&(t.cardholder_name=!0),"cardholder_identification_type"===e[n]&&(t.cardholder_identification_type=!0),"cardholder_identification_number"===e[n]&&(t.cardholder_identification_number=!0);return t},clearInstallmentsComponent(){const e=document.querySelector(CheckoutElements.mpInstallmentsContainer);e.classList.remove(CheckoutElements.mpInstallmentsContainer),e.firstElementChild&&e.removeChild(e.firstElementChild)},showInstallmentsComponent(e){const t=document.querySelector(CheckoutElements.mpInstallmentsContainer);t.classList.add(CheckoutElements.mpInstallmentsContainer),t.appendChild(e)},shouldEnableInstallmentsComponent(e){if("debit_card"===e)return this.clearInstallmentsComponent(),void(this.installmentsEnabled=!1);this.installmentsEnabled=!0},hideErrors(){document.querySelector(".mp-checkout-custom-container").querySelectorAll("input-helper").forEach((e=>{e.querySelector("div").style.display="none"}))},clearInputs(){this.hideErrors(),this.setBackground("fcCardNumberContainer","no-repeat #fff"),this.setValueOn("fcCardholderName",""),this.setDisplayOfError("fcCardholderName","removed","mp-error"),this.setValueOn("fcCardExpirationDateContainer",""),this.setDisplayOfError("fcCardExpirationDateContainer","removed","mp-error"),this.setValueOn("fcSecurityNumberContainer",""),this.setDisplayOfError("fcSecurityNumberContainer","removed","mp-error"),this.setValueOn("fcIdentificationNumber",""),this.setElementDisplay("mpDocumentContainer","none"),this.setDisplayOfError("fcIdentificationNumberContainer","removed","mp-error"),this.clearInstallmentsComponent(),this.setElementDisplay("mpInstallmentsCard","none"),document.querySelector("input[data-cy=input-document]").value=""},needsBankInterestDisclaimer(){const e=this.getCountry();return"MLC"===e.toUpperCase()||"MCO"===e.toUpperCase()||"MPE"===e.toUpperCase()},getInstallments(e){let t=[];const n=[];return this.clearInstallmentsComponent(),t="MCO"===this.getCountry()?e.payer_costs.slice(0,Math.min(6,e.payer_costs.length)):e.payer_costs,t&&this.setElementDisplay("mpInstallmentsCard","block"),t.forEach((e=>{const t=e.installments,r=this.formatCurrency(e.installment_amount),s=0!==e.installment_rate,o=this.formatCurrency(e.total_amount);let l=`${t.toString()}x `;1==t?l+=o:this.needsBankInterestDisclaimer()?l+=`${r} (${o}) + ${wc_mercadopago_custom_checkout_params.input_helper_message.installments.bank_interest_option_text}`:l+=s?`${r} (${o})`:`${r} ${wc_mercadopago_custom_checkout_params.input_helper_message.installments.interest_free_option_text}`;const a={value:t.toString(),title:l};if("MLA"===this.getCountry()&&e.labels){const t=this.parseTaxInfo(e.labels);t&&(a.taxInfo=t)}n.push(a)})),n},parseTaxInfo(e){if(!e||!Array.isArray(e))return null;const t={cft:null,tna:null,tea:null},n=e=>{if(!e)return null;const t=e.replace("%","").trim();return/^\d+([,.]\d+)?$/.test(t)?t:null};return e.forEach((e=>{if("string"!=typeof e)return;e.split("|").forEach((e=>{if(e.includes("CFT_")){const r=e.split("CFT_");if(r.length>1&&r[1]){const e=n(r[1]);e&&(t.cft=e)}}else if(e.includes("TEA_")){const r=e.split("TEA_");if(r.length>1&&r[1]){const e=n(r[1]);e&&(t.tea=e)}}else if(e.includes("TNA_")){const r=e.split("TNA_");if(r.length>1&&r[1]){const e=n(r[1]);e&&(t.tna=e)}}}))})),t},verifyInstallmentsContainer(){try{const e=document.querySelector(CheckoutElements.mpInstallmentsContainer);if(e&&e.firstElementChild)return e.firstElementChild.state.hasInteracted=!0,e.firstElementChild.validate()}catch(e){return console.error("Error verifying installments container",e),!1}},verifyCardholderName(){const e=document.querySelector(CheckoutElements.fcCardholderName),t=document.querySelector("#mp-card-holder-name-helper");if(!e)return!0;const n=e.value&&e.value.trim().length>0;return n?(t&&(t.style.display="none"),this.setDisplayOfError("fcCardholderName","remove","mp-error")):(t&&(t.style.display="flex"),this.setDisplayOfError("fcCardholderName","add","mp-error")),n},setChangeEventOnInstallments(e){this.clearInstallmentsComponent();const t=this.getInstallments(e),n=document.getElementById("form-checkout__installments");if(!this.installmentsEnabled)return CheckoutPage.setValueOn("cardInstallments","1"),void(n.value="1");const r=document.createElement("andes-dropdown");r.setAttribute("id",CheckoutElements.mpInstallments),r.setAttribute("label",wc_mercadopago_custom_checkout_params.input_title.installments),r.setAttribute("placeholder",wc_mercadopago_custom_checkout_params.placeholders.installments),r.setAttribute("items",JSON.stringify(t)),r.setAttribute("required-message",wc_mercadopago_custom_checkout_params.input_helper_message.installments.required),r.setAttribute("site-id",this.getCountry()),this.needsBankInterestDisclaimer()&&r.setAttribute("hint",wc_mercadopago_custom_checkout_params.input_helper_message.installments.bank_interest_hint_text),r.addEventListener("change",(e=>{const t=e.detail;t&&(this.setValueOn("cardInstallments",t.value),n.value=t.value)})),this.showInstallmentsComponent(r),this.setElementDisplay("mpInstallmentsCard","block")}};