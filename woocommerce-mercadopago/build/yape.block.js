(()=>{"use strict";var e={20:(e,t,s)=>{var o=s(609),r=Symbol.for("react.element"),n=(Symbol.for("react.fragment"),Object.prototype.hasOwnProperty),c=o.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,a={key:!0,ref:!0,__self:!0,__source:!0};function i(e,t,s){var o,i={},p=null,l=null;for(o in void 0!==s&&(p=""+s),void 0!==t.key&&(p=""+t.key),void 0!==t.ref&&(l=t.ref),t)n.call(t,o)&&!a.hasOwnProperty(o)&&(i[o]=t[o]);if(e&&e.defaultProps)for(o in t=e.defaultProps)void 0===i[o]&&(i[o]=t[o]);return{$$typeof:r,type:e,key:p,ref:l,props:i,_owner:c.current}}t.jsx=i,t.jsxs=i},609:e=>{e.exports=window.React},848:(e,t,s)=>{e.exports=s(20)}},t={};const s=window.wc.wcBlocksRegistry,o=window.wc.wcSettings,r=window.wp.element,n=window.wp.htmlEntities,c="mercadopago_blocks_update_cart";var a=function s(o){var r=t[o];if(void 0!==r)return r.exports;var n=t[o]={exports:{}};return e[o](n,n.exports,s),n.exports}(848);const i=({description:e,linkText:t,linkSrc:s,checkoutClass:o="pro"})=>(0,a.jsx)("div",{className:`mp-checkout-${o}-terms-and-conditions`,children:(0,a.jsx)("terms-and-conditions",{description:e,"link-text":t,"link-src":s})}),p=({title:e,description:t,linkText:s,linkSrc:o})=>(0,a.jsx)("div",{className:"mp-test-mode-container",children:(0,a.jsx)("test-mode",{title:e,description:t,"link-text":s,"link-src":o})}),l=({labelMessage:e,emptyErrorMessage:t,invalidErrorMessage:s})=>(0,a.jsx)("input-field",{"label-message":e,"empty-error-message":t,"invalid-error-message":s}),d=({label:e,src:t,emptyErrorMessage:s,invalidErrorMessage:o,tooltipText:r})=>(0,a.jsx)("input-code",{label:e,src:t,"empty-error-message":s,"invalid-error-message":o,"tooltip-text":r}),m=({message:e,src:t,icon:s,footerText:o})=>(0,a.jsx)("checkout-notice",{message:e,src:t,icon:s,"footer-text":o}),_=({text:e,imgSrc:t,id:s})=>(0,a.jsxs)("div",{id:s,className:"row-image-select",children:[(0,a.jsx)("img",{src:t}),(0,a.jsx)("p",{children:e})]});var u;const y="mp_checkout_blocks",x="woo-mercado-pago-yape",k=(0,o.getSetting)("woo-mercado-pago-yape_data",{}),g=(0,n.decodeEntities)(k.title)||"Checkout Yape",h=()=>{const e=(0,n.decodeEntities)(k?.params?.fee_title||""),t=`${g} ${e}`;return(0,a.jsx)(_,{text:t,imgSrc:k.params.checkout_blocks_row_image_src})},f=e=>{(e=>{const{extensionCartUpdate:t}=wc.blocksCheckout,{eventRegistration:s,emitResponse:o}=e,{onPaymentSetup:n,onCheckoutSuccess:a,onCheckoutFail:i}=s;(0,r.useEffect)((()=>{((e,t)=>{e({namespace:c,data:{action:"add",gateway:t}})})(t,x);const e=n((()=>({type:o.responseTypes.SUCCESS})));return()=>(((e,t)=>{e({namespace:c,data:{action:"remove",gateway:t}})})(t,x),e())}),[n]),(0,r.useEffect)((()=>{const e=a((async e=>{const t=e.processingResponse;return sendMetric("MP_YAPE_BLOCKS_SUCCESS",t.paymentStatus,y),{type:o.responseTypes.SUCCESS}}));return()=>e()}),[a]),(0,r.useEffect)((()=>{const e=i((e=>{const t=e.processingResponse;return sendMetric("MP_YAPE_BLOCKS_ERROR",t.paymentStatus,y),{type:o.responseTypes.FAIL,messageContext:o.noticeContexts.PAYMENTS,message:t.paymentDetails.message}}));return()=>e()}),[i])})(e);const{test_mode:t,test_mode_title:s,test_mode_description:o,test_mode_link_text:n,test_mode_link_src:_,terms_and_conditions_description:u,terms_and_conditions_link_text:g,terms_and_conditions_link_src:h,input_field_label:f,yape_title:v,yape_subtitle:w,input_code_icon:S,checkout_notice_icon_one:E,checkout_notice_icon_two:j,checkout_notice_message:b,input_code_label:R,footer_text:C,yape_tooltip_text:T,yape_input_code_error_message1:N,yape_input_code_error_message2:M,yape_phone_number_error_message1:P,yape_phone_number_error_message2:O}=k.params,U=(0,r.useRef)(null),{eventRegistration:B,emitResponse:L}=e,{onPaymentSetup:A}=B;return window.mpFormId="blocks_checkout_form",window.mpCheckoutForm=document.querySelector(".wc-block-components-form.wc-block-checkout__form"),(0,r.useEffect)((()=>{const e=A((async()=>{const e=getCodeValue(),t=document.getElementById("checkout__yapePhoneNumber").value.replaceAll(" ","");if(""===e&&""===t)return document.getElementsByTagName("input-field")[0].validate(),document.getElementsByTagName("input-code")[0].validate(),{type:L.responseTypes.ERROR};const s={otp:e,phoneNumber:t},o={},r=new MercadoPago(wc_mercadopago_yape_checkout_params.public_key).yape(s);try{const e=await r.create();o["mercadopago_yape[token]"]=e.id}catch(e){return console.warn("Token creation error: ",e),{type:L.responseTypes.ERROR}}return{type:L.responseTypes.SUCCESS,meta:{paymentMethodData:o}}}));return()=>e()}),[A,L.responseTypes.ERROR,L.responseTypes.SUCCESS]),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"mp-checkout-custom-load",children:(0,a.jsx)("div",{className:"spinner-card-form"})}),(0,a.jsxs)("div",{className:"mp-checkout-yape-container",children:[(0,a.jsxs)("div",{ref:U,className:"mp-checkout-yape-content",children:[(0,a.jsx)("div",{className:"mp-checkout-yape-test-mode",children:t?(0,a.jsx)(p,{title:s,description:o,linkText:n,linkSrc:_}):null}),(0,a.jsxs)("div",{className:"mp-checkout-yape-title-container",children:[(0,a.jsx)("h2",{className:"mp-checkout-yape-title",children:v}),(0,a.jsx)("p",{className:"mp-checkout-yape-subtitle",children:w})]}),(0,a.jsxs)("div",{className:"mp-checkout-yape-inputs",children:[(0,a.jsx)(l,{labelMessage:f,emptyErrorMessage:P,invalidErrorMessage:O}),(0,a.jsx)(d,{label:R,src:S,emptyErrorMessage:N,invalidErrorMessage:M,tooltipText:T})]}),(0,a.jsxs)(m,{message:b,src:E,icon:j,children:["footerText=",C]})]}),(0,a.jsx)("div",{className:"mp-checkout-yape-terms-and-conditions",children:(0,a.jsx)(i,{description:u,linkText:g,linkSrc:h})})]}),(0,a.jsx)("div",{id:"mercadopago-utilities",style:{display:"none"},children:(0,a.jsx)("input",{type:"hidden",id:"yapeToken",name:"mercadopago_yape[token]"})})]})},v={name:x,label:(0,a.jsx)(h,{}),content:(0,a.jsx)(f,{}),edit:(0,a.jsx)(f,{}),canMakePayment:()=>!0,ariaLabel:g,supports:{features:null!==(u=k?.supports)&&void 0!==u?u:[]}};(0,s.registerPaymentMethod)(v)})();