(()=>{"use strict";var e={20:(e,t,s)=>{var o=s(609),n=Symbol.for("react.element"),r=(Symbol.for("react.fragment"),Object.prototype.hasOwnProperty),a=o.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,c={key:!0,ref:!0,__self:!0,__source:!0};function i(e,t,s){var o,i={},p=null,l=null;for(o in void 0!==s&&(p=""+s),void 0!==t.key&&(p=""+t.key),void 0!==t.ref&&(l=t.ref),t)r.call(t,o)&&!c.hasOwnProperty(o)&&(i[o]=t[o]);if(e&&e.defaultProps)for(o in t=e.defaultProps)void 0===i[o]&&(i[o]=t[o]);return{$$typeof:n,type:e,key:p,ref:l,props:i,_owner:a.current}}t.jsx=i,t.jsxs=i},609:e=>{e.exports=window.React},848:(e,t,s)=>{e.exports=s(20)}},t={};const s=window.wc.wcBlocksRegistry,o=window.wc.wcSettings,n=window.wp.element,r=window.wp.htmlEntities,a="mercadopago_blocks_update_cart";var c=function s(o){var n=t[o];if(void 0!==n)return n.exports;var r=t[o]={exports:{}};return e[o](r,r.exports,s),r.exports}(848);const i=({description:e,linkText:t,linkSrc:s,checkoutClass:o="pro"})=>(0,c.jsx)("div",{className:`mp-checkout-${o}-terms-and-conditions`,children:(0,c.jsx)("terms-and-conditions",{description:e,"link-text":t,"link-src":s})}),p=({title:e,description:t,linkText:s,linkSrc:o})=>(0,c.jsx)("div",{className:"mp-test-mode-container",children:(0,c.jsx)("test-mode",{title:e,description:t,"link-text":s,"link-src":o})}),l=({labelMessage:e,emptyErrorMessage:t,invalidErrorMessage:s})=>(0,c.jsx)("input-field",{"label-message":e,"empty-error-message":t,"invalid-error-message":s}),d=({label:e,src:t,emptyErrorMessage:s,invalidErrorMessage:o,tooltipText:n})=>(0,c.jsx)("input-code",{label:e,src:t,"empty-error-message":s,"invalid-error-message":o,"tooltip-text":n}),m=({message:e,src:t,icon:s,footerText:o})=>(0,c.jsx)("checkout-notice",{message:e,src:t,icon:s,"footer-text":o});var _;const u="mp_checkout_blocks",y="woo-mercado-pago-yape",k=(0,o.getSetting)("woo-mercado-pago-yape_data",{}),x=(0,r.decodeEntities)(k.title)||"Checkout Yape",g=e=>{const{PaymentMethodLabel:t}=e.components,s=(0,r.decodeEntities)(k?.params?.fee_title||""),o=`${x} ${s}`;return(0,c.jsx)(t,{text:o})},h=e=>{(e=>{const{extensionCartUpdate:t}=wc.blocksCheckout,{eventRegistration:s,emitResponse:o}=e,{onPaymentSetup:r,onCheckoutSuccess:c,onCheckoutFail:i}=s;(0,n.useEffect)((()=>{((e,t)=>{e({namespace:a,data:{action:"add",gateway:t}})})(t,y);const e=r((()=>({type:o.responseTypes.SUCCESS})));return()=>(((e,t)=>{e({namespace:a,data:{action:"remove",gateway:t}})})(t,y),e())}),[r]),(0,n.useEffect)((()=>{const e=c((async e=>{const t=e.processingResponse;return sendMetric("MP_YAPE_BLOCKS_SUCCESS",t.paymentStatus,u),{type:o.responseTypes.SUCCESS}}));return()=>e()}),[c]),(0,n.useEffect)((()=>{const e=i((e=>{const t=e.processingResponse;return sendMetric("MP_YAPE_BLOCKS_ERROR",t.paymentStatus,u),{type:o.responseTypes.FAIL,messageContext:o.noticeContexts.PAYMENTS,message:t.paymentDetails.message}}));return()=>e()}),[i])})(e);const{test_mode:t,test_mode_title:s,test_mode_description:o,test_mode_link_text:r,test_mode_link_src:_,terms_and_conditions_description:x,terms_and_conditions_link_text:g,terms_and_conditions_link_src:h,input_field_label:f,yape_title:v,yape_subtitle:w,input_code_icon:E,checkout_notice_icon_one:S,checkout_notice_icon_two:j,checkout_notice_message:b,input_code_label:R,footer_text:C,yape_tooltip_text:T,yape_input_code_error_message1:M,yape_input_code_error_message2:N,yape_phone_number_error_message1:P,yape_phone_number_error_message2:O}=k.params,L=(0,n.useRef)(null),{eventRegistration:U,emitResponse:B}=e,{onPaymentSetup:A}=U;return window.mpFormId="blocks_checkout_form",window.mpCheckoutForm=document.querySelector(".wc-block-components-form.wc-block-checkout__form"),(0,n.useEffect)((()=>{const e=A((async()=>{const e=getCodeValue(),t=document.getElementById("checkout__yapePhoneNumber").value.replaceAll(" ","");if(""===e&&""===t)return document.getElementsByTagName("input-field")[0].validate(),document.getElementsByTagName("input-code")[0].validate(),{type:B.responseTypes.ERROR};const s={otp:e,phoneNumber:t},o={},n=new MercadoPago(wc_mercadopago_yape_checkout_params.public_key).yape(s);try{const e=await n.create();o["mercadopago_yape[token]"]=e.id}catch(e){return console.warn("Token creation error: ",e),{type:B.responseTypes.ERROR}}return{type:B.responseTypes.SUCCESS,meta:{paymentMethodData:o}}}));return()=>e()}),[A,B.responseTypes.ERROR,B.responseTypes.SUCCESS]),(0,c.jsxs)("div",{children:[(0,c.jsx)("div",{className:"mp-checkout-custom-load",children:(0,c.jsx)("div",{className:"spinner-card-form"})}),(0,c.jsxs)("div",{className:"mp-checkout-yape-container",children:[(0,c.jsxs)("div",{ref:L,className:"mp-checkout-yape-content",children:[(0,c.jsx)("div",{className:"mp-checkout-yape-test-mode",children:t?(0,c.jsx)(p,{title:s,description:o,linkText:r,linkSrc:_}):null}),(0,c.jsxs)("div",{className:"mp-checkout-yape-title-container",children:[(0,c.jsx)("h2",{className:"mp-checkout-yape-title",children:v}),(0,c.jsx)("p",{className:"mp-checkout-yape-subtitle",children:w})]}),(0,c.jsxs)("div",{className:"mp-checkout-yape-inputs",children:[(0,c.jsx)(l,{labelMessage:f,emptyErrorMessage:P,invalidErrorMessage:O}),(0,c.jsx)(d,{label:R,src:E,emptyErrorMessage:M,invalidErrorMessage:N,tooltipText:T})]}),(0,c.jsxs)(m,{message:b,src:S,icon:j,children:["footerText=",C]})]}),(0,c.jsx)("div",{className:"mp-checkout-yape-terms-and-conditions",children:(0,c.jsx)(i,{description:x,linkText:g,linkSrc:h})})]}),(0,c.jsx)("div",{id:"mercadopago-utilities",style:{display:"none"},children:(0,c.jsx)("input",{type:"hidden",id:"yapeToken",name:"mercadopago_yape[token]"})})]})},f={name:y,label:(0,c.jsx)(g,{}),content:(0,c.jsx)(h,{}),edit:(0,c.jsx)(h,{}),canMakePayment:()=>!0,ariaLabel:x,supports:{features:null!==(_=k?.supports)&&void 0!==_?_:[]}};(0,s.registerPaymentMethod)(f)})();